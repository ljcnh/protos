syntax = "proto3";
package common;
option go_package = "common";

// ErrorCode - 业务错误码定义，与base.StatusCode配合使用
// base.StatusCode表示框架层面状态，ErrorCode表示具体业务错误类型
// 注意：不要与StatusCode重复，这里专注于业务逻辑层面的错误
enum ErrorCode {
    ERROR_CODE_UNSPECIFIED = 0;              // 未指定错误
    ERROR_CODE_BUSINESS_RULE_VIOLATION = 1;  // 业务规则违反
    ERROR_CODE_RESOURCE_LOCKED = 2;          // 资源锁定 - 资源正被其他操作占用
    ERROR_CODE_QUOTA_EXCEEDED = 3;           // 配额超限 - 超过业务限制额度
    ERROR_CODE_DEPENDENCY_FAILED = 4;        // 依赖服务失败 - 外部服务调用失败
    ERROR_CODE_DATA_CONSISTENCY = 5;         // 数据一致性错误 - 数据状态异常
    ERROR_CODE_VERSION_CONFLICT = 6;         // 版本冲突 - 乐观锁冲突
    ERROR_CODE_FEATURE_DISABLED = 7;         // 功能未启用
    ERROR_CODE_RATE_LIMIT_EXCEEDED = 8;      // 限流超限 - 超过请求频率限制
    ERROR_CODE_WORKFLOW_ERROR = 9;           // 工作流执行错误
    ERROR_CODE_VALIDATION_FAILED = 10;       // 业务验证失败
}

// ErrorDetail - 错误详情
message ErrorDetail {
    ErrorCode code = 1;                 // 错误码
    string message = 2;                 // 错误消息
    string request_id = 3;              // 请求ID，用于追踪
    map<string, string> metadata = 4;   // 错误元数据
}
